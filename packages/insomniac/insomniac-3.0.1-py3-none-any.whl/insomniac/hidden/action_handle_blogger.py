from functools import partial

from insomniac.device_facade import DeviceFacade
from insomniac.interaction import interact_with_user, is_follow_limit_reached_for_source
from insomniac.navigation import search_for
from insomniac.storage import FollowingStatus
from insomniac.utils import *

import base64

code = base64.b64decode(b'Rk9MTE9XRVJTX0JVVFRPTl9JRF9SRUdFWCA9ICdjb20uaW5zdGFncmFtLmFuZHJvaWQ6aWQvcm93X3Byb2ZpbGVfaGVhZGVyX2ZvbGxvd2Vyc19jb250YWluZXInIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICd8Y29tLmluc3RhZ3JhbS5hbmRyb2lkOmlkL3Jvd19wcm9maWxlX2hlYWRlcl9jb250YWluZXJfZm9sbG93ZXJzJwoKCmRlZiBoYW5kbGVfYmxvZ2dlcihkZXZpY2UsCiAgICAgICAgICAgICAgICAgICB1c2VybmFtZSwKICAgICAgICAgICAgICAgICAgIHNlc3Npb25fc3RhdGUsCiAgICAgICAgICAgICAgICAgICBsaWtlc19jb3VudCwKICAgICAgICAgICAgICAgICAgIGZvbGxvd19wZXJjZW50YWdlLAogICAgICAgICAgICAgICAgICAgZm9sbG93X2xpbWl0LAogICAgICAgICAgICAgICAgICAgc3RvcmFnZSwKICAgICAgICAgICAgICAgICAgIHByb2ZpbGVfZmlsdGVyLAogICAgICAgICAgICAgICAgICAgb25fbGlrZSwKICAgICAgICAgICAgICAgICAgIG9uX2ludGVyYWN0aW9uKToKICAgIGlzX215c2VsZiA9IHVzZXJuYW1lID09IHNlc3Npb25fc3RhdGUubXlfdXNlcm5hbWUKICAgIGludGVyYWN0aW9uID0gcGFydGlhbChpbnRlcmFjdF93aXRoX3VzZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgbXlfdXNlcm5hbWU9c2Vzc2lvbl9zdGF0ZS5teV91c2VybmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICBsaWtlc19jb3VudD1saWtlc19jb3VudCwKICAgICAgICAgICAgICAgICAgICAgICAgICBmb2xsb3dfcGVyY2VudGFnZT1mb2xsb3dfcGVyY2VudGFnZSwKICAgICAgICAgICAgICAgICAgICAgICAgICBvbl9saWtlPW9uX2xpa2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZmlsZV9maWx0ZXI9cHJvZmlsZV9maWx0ZXIpCiAgICBpc19mb2xsb3dfbGltaXRfcmVhY2hlZCA9IHBhcnRpYWwoaXNfZm9sbG93X2xpbWl0X3JlYWNoZWRfZm9yX3NvdXJjZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXNzaW9uX3N0YXRlPXNlc3Npb25fc3RhdGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9sbG93X2xpbWl0PWZvbGxvd19saW1pdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U9dXNlcm5hbWUpCgogICAgaWYgbm90IF9vcGVuX3VzZXJfZm9sbG93ZXJzKGRldmljZSwgdXNlcm5hbWUpOgogICAgICAgIHJldHVybgogICAgaWYgaXNfbXlzZWxmOgogICAgICAgIF9zY3JvbGxfdG9fYm90dG9tKGRldmljZSkKICAgIF9pdGVyYXRlX292ZXJfZm9sbG93ZXJzKGRldmljZSwgaW50ZXJhY3Rpb24sIGlzX2ZvbGxvd19saW1pdF9yZWFjaGVkLCBzdG9yYWdlLCBvbl9pbnRlcmFjdGlvbiwgaXNfbXlzZWxmKQoKCmRlZiBfb3Blbl91c2VyX2ZvbGxvd2VycyhkZXZpY2UsIHVzZXJuYW1lKToKICAgIGlmIHVzZXJuYW1lIGlzIE5vbmU6CiAgICAgICAgcHJpbnQoIk9wZW4geW91ciBmb2xsb3dlcnMiKQogICAgICAgIGZvbGxvd2Vyc19idXR0b24gPSBkZXZpY2UuZmluZChyZXNvdXJjZUlkTWF0Y2hlcz1GT0xMT1dFUlNfQlVUVE9OX0lEX1JFR0VYKQogICAgICAgIGZvbGxvd2Vyc19idXR0b24uY2xpY2soKQogICAgZWxzZToKICAgICAgICBpZiBub3Qgc2VhcmNoX2ZvcihkZXZpY2UsIHVzZXJuYW1lPXVzZXJuYW1lKToKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgICAgIHByaW50KCJPcGVuIEAiICsgdXNlcm5hbWUgKyAiIGZvbGxvd2VycyIpCiAgICAgICAgZm9sbG93ZXJzX2J1dHRvbiA9IGRldmljZS5maW5kKHJlc291cmNlSWRNYXRjaGVzPUZPTExPV0VSU19CVVRUT05fSURfUkVHRVgpCiAgICAgICAgZm9sbG93ZXJzX2J1dHRvbi5jbGljaygpCgogICAgcmV0dXJuIFRydWUKCgpkZWYgX3Njcm9sbF90b19ib3R0b20oZGV2aWNlKToKICAgIHByaW50KCJTY3JvbGwgdG8gYm90dG9tIikKCiAgICBkZWYgaXNfZW5kX3JlYWNoZWQoKToKICAgICAgICBzZWVfYWxsX2J1dHRvbiA9IGRldmljZS5maW5kKHJlc291cmNlSWQ9J2NvbS5pbnN0YWdyYW0uYW5kcm9pZDppZC9zZWVfYWxsX2J1dHRvbicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9J2FuZHJvaWQud2lkZ2V0LlRleHRWaWV3JykKICAgICAgICByZXR1cm4gc2VlX2FsbF9idXR0b24uZXhpc3RzKCkKCiAgICBsaXN0X3ZpZXcgPSBkZXZpY2UuZmluZChyZXNvdXJjZUlkPSdhbmRyb2lkOmlkL2xpc3QnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPSdhbmRyb2lkLndpZGdldC5MaXN0VmlldycpCiAgICB3aGlsZSBub3QgaXNfZW5kX3JlYWNoZWQoKToKICAgICAgICBsaXN0X3ZpZXcuc3dpcGUoRGV2aWNlRmFjYWRlLkRpcmVjdGlvbi5CT1RUT00pCgogICAgcHJpbnQoIlNjcm9sbCBiYWNrIHRvIHRoZSBmaXJzdCBmb2xsb3dlciIpCgogICAgZGVmIGlzX2F0X2xlYXN0X29uZV9mb2xsb3dlcigpOgogICAgICAgIGZvbGxvd2VyID0gZGV2aWNlLmZpbmQocmVzb3VyY2VJZD0nY29tLmluc3RhZ3JhbS5hbmRyb2lkOmlkL2ZvbGxvd19saXN0X2NvbnRhaW5lcicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9J2FuZHJvaWQud2lkZ2V0LkxpbmVhckxheW91dCcpCiAgICAgICAgcmV0dXJuIGZvbGxvd2VyLmV4aXN0cygpCgogICAgd2hpbGUgbm90IGlzX2F0X2xlYXN0X29uZV9mb2xsb3dlcigpOgogICAgICAgIGxpc3Rfdmlldy5zY3JvbGwoRGV2aWNlRmFjYWRlLkRpcmVjdGlvbi5UT1ApCgoKZGVmIF9pdGVyYXRlX292ZXJfZm9sbG93ZXJzKGRldmljZSwgaW50ZXJhY3Rpb24sIGlzX2ZvbGxvd19saW1pdF9yZWFjaGVkLCBzdG9yYWdlLCBvbl9pbnRlcmFjdGlvbiwgaXNfbXlzZWxmKToKICAgICMgV2FpdCB1bnRpbCBsaXN0IGlzIHJlbmRlcmVkCiAgICBkZXZpY2UuZmluZChyZXNvdXJjZUlkPSdjb20uaW5zdGFncmFtLmFuZHJvaWQ6aWQvZm9sbG93X2xpc3RfY29udGFpbmVyJywKICAgICAgICAgICAgICAgIGNsYXNzTmFtZT0nYW5kcm9pZC53aWRnZXQuTGluZWFyTGF5b3V0Jykud2FpdCgpCgogICAgZGVmIHNjcm9sbGVkX3RvX3RvcCgpOgogICAgICAgIHJvd19zZWFyY2ggPSBkZXZpY2UuZmluZChyZXNvdXJjZUlkPSdjb20uaW5zdGFncmFtLmFuZHJvaWQ6aWQvcm93X3NlYXJjaF9lZGl0X3RleHQnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9J2FuZHJvaWQud2lkZ2V0LkVkaXRUZXh0JykKICAgICAgICByZXR1cm4gcm93X3NlYXJjaC5leGlzdHMoKQoKICAgIHByZXZfc2NyZWVuX2l0ZXJhdGVkX2ZvbGxvd2VycyA9IFtdCiAgICB3aGlsZSBUcnVlOgogICAgICAgIHByaW50KCJJdGVyYXRlIG92ZXIgdmlzaWJsZSBmb2xsb3dlcnMiKQogICAgICAgIHJhbmRvbV9zbGVlcCgpCiAgICAgICAgc2NyZWVuX2l0ZXJhdGVkX2ZvbGxvd2VycyA9IFtdCiAgICAgICAgc2NyZWVuX3NraXBwZWRfZm9sbG93ZXJzX2NvdW50ID0gMAoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGZvciBpdGVtIGluIGRldmljZS5maW5kKHJlc291cmNlSWQ9J2NvbS5pbnN0YWdyYW0uYW5kcm9pZDppZC9mb2xsb3dfbGlzdF9jb250YWluZXInLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9J2FuZHJvaWQud2lkZ2V0LkxpbmVhckxheW91dCcpOgogICAgICAgICAgICAgICAgdXNlcl9pbmZvX3ZpZXcgPSBpdGVtLmNoaWxkKGluZGV4PTEpCiAgICAgICAgICAgICAgICB1c2VyX25hbWVfdmlldyA9IHVzZXJfaW5mb192aWV3LmNoaWxkKGluZGV4PTApLmNoaWxkKCkKICAgICAgICAgICAgICAgIGlmIG5vdCB1c2VyX25hbWVfdmlldy5leGlzdHMocXVpY2s9VHJ1ZSk6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoQ09MT1JfT0tHUkVFTiArICJOZXh0IGl0ZW0gbm90IGZvdW5kOiBwcm9iYWJseSByZWFjaGVkIGVuZCBvZiB0aGUgc2NyZWVuLiIgKyBDT0xPUl9FTkRDKQogICAgICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICAgICAgdXNlcm5hbWUgPSB1c2VyX25hbWVfdmlldy5nZXRfdGV4dCgpCiAgICAgICAgICAgICAgICBzY3JlZW5faXRlcmF0ZWRfZm9sbG93ZXJzLmFwcGVuZCh1c2VybmFtZSkKCiAgICAgICAgICAgICAgICBpZiBub3QgaXNfbXlzZWxmIGFuZCBzdG9yYWdlLmNoZWNrX3VzZXJfd2FzX2ludGVyYWN0ZWQodXNlcm5hbWUpOgogICAgICAgICAgICAgICAgICAgIHByaW50KCJAIiArIHVzZXJuYW1lICsgIjogYWxyZWFkeSBpbnRlcmFjdGVkLiBTa2lwLiIpCiAgICAgICAgICAgICAgICAgICAgc2NyZWVuX3NraXBwZWRfZm9sbG93ZXJzX2NvdW50ICs9IDEKICAgICAgICAgICAgICAgIGVsaWYgaXNfbXlzZWxmIGFuZCBzdG9yYWdlLmNoZWNrX3VzZXJfd2FzX2ludGVyYWN0ZWRfcmVjZW50bHkodXNlcm5hbWUpOgogICAgICAgICAgICAgICAgICAgIHByaW50KCJAIiArIHVzZXJuYW1lICsgIjogYWxyZWFkeSBpbnRlcmFjdGVkIGluIHRoZSBsYXN0IHdlZWsuIFNraXAuIikKICAgICAgICAgICAgICAgICAgICBzY3JlZW5fc2tpcHBlZF9mb2xsb3dlcnNfY291bnQgKz0gMQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBwcmludCgiQCIgKyB1c2VybmFtZSArICI6IGludGVyYWN0IikKICAgICAgICAgICAgICAgICAgICB1c2VyX25hbWVfdmlldy5jbGljaygpCgogICAgICAgICAgICAgICAgICAgIGNhbl9mb2xsb3cgPSBub3QgaXNfbXlzZWxmIFwKICAgICAgICAgICAgICAgICAgICAgICAgYW5kIG5vdCBpc19mb2xsb3dfbGltaXRfcmVhY2hlZCgpIFwKICAgICAgICAgICAgICAgICAgICAgICAgYW5kIHN0b3JhZ2UuZ2V0X2ZvbGxvd2luZ19zdGF0dXModXNlcm5hbWUpID09IEZvbGxvd2luZ1N0YXR1cy5OT05FCgogICAgICAgICAgICAgICAgICAgIGludGVyYWN0aW9uX3N1Y2NlZWQsIGZvbGxvd2VkID0gaW50ZXJhY3Rpb24oZGV2aWNlLCB1c2VybmFtZT11c2VybmFtZSwgY2FuX2ZvbGxvdz1jYW5fZm9sbG93KQogICAgICAgICAgICAgICAgICAgIHN0b3JhZ2UuYWRkX2ludGVyYWN0ZWRfdXNlcih1c2VybmFtZSwgZm9sbG93ZWQ9Zm9sbG93ZWQpCiAgICAgICAgICAgICAgICAgICAgY2FuX2NvbnRpbnVlID0gb25faW50ZXJhY3Rpb24oc3VjY2VlZD1pbnRlcmFjdGlvbl9zdWNjZWVkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbGxvd2VkPWZvbGxvd2VkKQoKICAgICAgICAgICAgICAgICAgICBpZiBub3QgY2FuX2NvbnRpbnVlOgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoIkJhY2sgdG8gZm9sbG93ZXJzIGxpc3QiKQogICAgICAgICAgICAgICAgICAgIGRldmljZS5iYWNrKCkKICAgICAgICBleGNlcHQgSW5kZXhFcnJvcjoKICAgICAgICAgICAgcHJpbnQoQ09MT1JfRkFJTCArICJDYW5ub3QgZ2V0IG5leHQgaXRlbTogcHJvYmFibHkgcmVhY2hlZCBlbmQgb2YgdGhlIHNjcmVlbi4iICsgQ09MT1JfRU5EQykKCiAgICAgICAgaWYgaXNfbXlzZWxmIGFuZCBzY3JvbGxlZF90b190b3AoKToKICAgICAgICAgICAgcHJpbnQoQ09MT1JfT0tHUkVFTiArICJTY3JvbGxlZCB0byB0b3AsIGZpbmlzaC4iICsgQ09MT1JfRU5EQykKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZWxpZiBsZW4oc2NyZWVuX2l0ZXJhdGVkX2ZvbGxvd2VycykgPiAwOgogICAgICAgICAgICBsb2FkX21vcmVfYnV0dG9uID0gZGV2aWNlLmZpbmQocmVzb3VyY2VJZD0nY29tLmluc3RhZ3JhbS5hbmRyb2lkOmlkL3Jvd19sb2FkX21vcmVfYnV0dG9uJykKICAgICAgICAgICAgbG9hZF9tb3JlX2J1dHRvbl9leGlzdHMgPSBsb2FkX21vcmVfYnV0dG9uLmV4aXN0cyhxdWljaz1UcnVlKQoKICAgICAgICAgICAgaWYgbm90IGxvYWRfbW9yZV9idXR0b25fZXhpc3RzIGFuZCBzY3JlZW5faXRlcmF0ZWRfZm9sbG93ZXJzID09IHByZXZfc2NyZWVuX2l0ZXJhdGVkX2ZvbGxvd2VyczoKICAgICAgICAgICAgICAgIHByaW50KENPTE9SX09LR1JFRU4gKyAiSXRlcmF0ZWQgZXhhY3RseSB0aGUgc2FtZSBmb2xsb3dlcnMgdHdpY2UsIGZpbmlzaC4iICsgQ09MT1JfRU5EQykKICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgbmVlZF9zd2lwZSA9IHNjcmVlbl9za2lwcGVkX2ZvbGxvd2Vyc19jb3VudCA9PSBsZW4oc2NyZWVuX2l0ZXJhdGVkX2ZvbGxvd2VycykKICAgICAgICAgICAgbGlzdF92aWV3ID0gZGV2aWNlLmZpbmQocmVzb3VyY2VJZD0nYW5kcm9pZDppZC9saXN0JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPSdhbmRyb2lkLndpZGdldC5MaXN0VmlldycpCiAgICAgICAgICAgIGlmIGlzX215c2VsZjoKICAgICAgICAgICAgICAgIHByaW50KENPTE9SX09LR1JFRU4gKyAiTmVlZCB0byBzY3JvbGwgbm93IiArIENPTE9SX0VOREMpCiAgICAgICAgICAgICAgICBsaXN0X3ZpZXcuc2Nyb2xsKERldmljZUZhY2FkZS5EaXJlY3Rpb24uVE9QKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHJlc3NlZF9yZXRyeSA9IEZhbHNlCiAgICAgICAgICAgICAgICBpZiBsb2FkX21vcmVfYnV0dG9uX2V4aXN0czoKICAgICAgICAgICAgICAgICAgICByZXRyeV9idXR0b24gPSBsb2FkX21vcmVfYnV0dG9uLmNoaWxkKGNsYXNzTmFtZT0nYW5kcm9pZC53aWRnZXQuSW1hZ2VWaWV3JykKICAgICAgICAgICAgICAgICAgICBpZiByZXRyeV9idXR0b24uZXhpc3RzKCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHJ5X2J1dHRvbi5jbGljaygpCiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmRvbV9zbGVlcCgpCiAgICAgICAgICAgICAgICAgICAgICAgIHByZXNzZWRfcmV0cnkgPSBUcnVlCgogICAgICAgICAgICAgICAgaWYgbmVlZF9zd2lwZSBhbmQgbm90IHByZXNzZWRfcmV0cnk6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoQ09MT1JfT0tHUkVFTiArICJBbGwgZm9sbG93ZXJzIHNraXBwZWQsIGxldCdzIGRvIGEgc3dpcGUiICsgQ09MT1JfRU5EQykKICAgICAgICAgICAgICAgICAgICBsaXN0X3ZpZXcuc3dpcGUoRGV2aWNlRmFjYWRlLkRpcmVjdGlvbi5CT1RUT00pCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHByaW50KENPTE9SX09LR1JFRU4gKyAiTmVlZCB0byBzY3JvbGwgbm93IiArIENPTE9SX0VOREMpCiAgICAgICAgICAgICAgICAgICAgbGlzdF92aWV3LnNjcm9sbChEZXZpY2VGYWNhZGUuRGlyZWN0aW9uLkJPVFRPTSkKCiAgICAgICAgICAgIHByZXZfc2NyZWVuX2l0ZXJhdGVkX2ZvbGxvd2Vycy5jbGVhcigpCiAgICAgICAgICAgIHByZXZfc2NyZWVuX2l0ZXJhdGVkX2ZvbGxvd2VycyArPSBzY3JlZW5faXRlcmF0ZWRfZm9sbG93ZXJzCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnQoQ09MT1JfT0tHUkVFTiArICJObyBmb2xsb3dlcnMgd2VyZSBpdGVyYXRlZCwgZmluaXNoLiIgKyBDT0xPUl9FTkRDKQogICAgICAgICAgICByZXR1cm4K')
exec(code)
