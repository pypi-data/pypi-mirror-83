name: autoreadme

on:
  # Generate README.md if templates/docs were modified in default branches
  push:
    branches:
      - trunk
    paths:
      - "README.tpl"
      - "lib.rs"
      - "**readme.yml"

jobs:
  readme:
    name: Generate README
    runs-on: ubuntu-latest
    steps: 
      - name: Checkout repository
        uses: actions/checkout@v2
      - name: Install stable toolchain
        uses: actions-rs/toolchain@v1
        with:
          toolchain: stable
          override: true 
      - name: Install cargo-readme
        run: cargo install cargo-readme
      - name: Run and commit
        run: |
          cargo readme > README.md  
          git config user.name carrascomj
          git config user.email carrascomurielj@gmail.com
          git add README.md
          git commit -m 'docs: generate readme from template :robot:'
          git push origin trunk
          